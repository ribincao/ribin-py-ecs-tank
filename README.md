# py-ecs-demo

该项目是基于 ecs 框架复刻的一个单机/联机坦克大战游戏,项目主要用到 pygame 依赖

## 说明

1. 该项目的出发点是为了帮助自己深入了解 ECS 架构,游戏本身的玩法性不是考虑
2. 这套项目从 0 到 1 手撸 ECS,重点还是想自己去体验一下该架构下的联机设计,其中踩过的坑主要还是为了帮助自己提供游戏同步的设计能力
3. 本人对 ECS 的架构理解有可能会有偏颇,但是在写这个项目的过程中真实的体会到了 ECS 架构的一些可能存在的问题以及其强大的扩展能力,帮助我更好的理解这套体系
4. 本项目使用 python 实现的考量主要有两点:
   - 能够快速实现、快速的验证自己在设计上的一些可行性
   - 基于 pygame 能够很方便的收到实现效果的反馈,验证设想的效果和真实效是否一致
5. 项目里的 pygame 主要是用到他的渲染,其中的碰撞检测之类的功能都是自己手撸的丐版,但也就是在写这些可能偏表现的东西,也让我发现了 ECS 的一些可能存在问题
6. 项目中服务端分两层
   - 网络层:负责接受客户端发来的指令以及定时发送快照给客户端同步 world
   - 逻辑层:负责运行整个 world
7. 项目中的客户端简单分了四层:
   - 渲染层:目前使用的是 pygame,用来渲染 behavior.如果将来有更方便的 GUI 库也可以直接替换
   - 表现层:主要是完成逻辑层 entity 和 behavior 的绑定,同时向渲染层提供 behavior 以及 animation 的渲染
   - 逻辑层:和服务端公用一套代码保证逻辑的一致,同时定时接受客户端的快照去较正状态
   - 网络层:负责接受服务端的快照进行同步以及定时向服务端发送指令同步操作
8. 项目中核心的桥接是 context.py 文件,这也是我有些存疑的地方,欢迎懂 ECS 的朋友能够不吝赐教

## 使用

env

```shell
pip3 install pygame
```

单机

```python
python3 client.py
```

联机

```python
python3 server.py
python3 client.py  # 如果想多人联机的话就多开几个终端执行
```

日志: 可以通过修改 common/logger.py 文件里的 log_mode 为 LOG_MODE_CONSOLE/LOG_MODE_FILE 来选择输出日志到终端还是文件

## 玩法

1. n - 创建当前玩家
2. wasd - 对应移动
3. j - 射击
4. t - 创建一个机器敌人
